var get$=Ember.get;Em.onLoad("Ember.Application",function(e){return e.initializer({name:"ember-auth.module.rememberable",before:"ember-auth-load",initialize:function(e,t){return t.register("authModule:rememberable",get$(get$(Em,"Auth"),"RememberableAuthModule"),{singleton:!0}),t.inject("authModule:rememberable","auth","auth:main")}}),e.initializer({name:"ember-auth.module.rememberable-load",after:"ember-auth-load",initialize:function(e){return e.lookup("authModule:rememberable")}})});var get$=Ember.get,set$=Ember.set;set$(get$(Em,"Auth"),"RememberableAuthModule",Ember.Object.extend({init:function(){return get$(this,"auth")._config("rememberable",get$(this,"_defaultConfig")),null!=get$(this,"config")||set$(this,"config",get$(this,"auth")._config("rememberable")),this.patch(),get$(this,"auth").addHandler("signInSuccess",get$(this,"remember").bind(this)),get$(this,"auth").addHandler("signInError",get$(this,"forget").bind(this)),get$(this,"auth").addHandler("signOutSuccess",get$(this,"forget").bind(this))},_defaultConfig:{tokenKey:null,period:14,autoRecall:!0,endPoint:null},recall:function(e){var t;return null==e&&(e={}),!get$(get$(this,"auth"),"signedIn")&&(t=this.retrieveToken())?(set$(this,"fromRecall",!0),e.data||(e.data={}),get$(e,"data")[get$(get$(this,"config"),"tokenKey")]=t,null!=get$(get$(this,"config"),"endPoint")?get$(this,"auth").signIn(get$(get$(this,"config"),"endPoint"),e):get$(this,"auth").signIn(e)):new(get$(get$(Em,"RSVP"),"resolve"))},remember:function(e){var t;return get$(this,"fromRecall")||this.forget(),set$(this,"fromRecall",!1),(t=e[get$(get$(this,"config"),"tokenKey")])&&t!==this.retrieveToken()?this.storeToken(t):void 0},forget:function(){return this.removeToken()},retrieveToken:function(){return get$(get$(this,"auth"),"_session").retrieve("ember-auth-rememberable")},storeToken:function(e){return get$(get$(this,"auth"),"_session").store("ember-auth-rememberable",e,{expires:get$(get$(this,"config"),"period")})},removeToken:function(){return get$(get$(this,"auth"),"_session").remove("ember-auth-rememberable")},patch:function(){var e;return e=this,get$(Em,"Route").reopen({beforeModel:function(){return get$(e,"auth")._ensurePromise(this._super.apply(this,arguments)).then(function(){return get$(get$(e,"config"),"autoRecall")&&!get$(get$(e,"auth"),"signedIn")?e.recall():void 0})}})}}));